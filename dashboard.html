<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eagle Homes | Advanced Property Management</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; }
        [x-cloak] { display: none !important; }
        .sidebar-link.active { background-color: #eff6ff; color: #2563eb; border-right: 3px solid #2563eb; }
        @media print {
            .no-print { display: none !important; }
            .print-area { border: none !important; width: 100% !important; margin: 0 !important; }
        }
        input:focus { outline: none; border-color: #3b82f6; ring: 2px #3b82f6; }
    </style>
</head>
<body x-data="managementSystem()" class="min-h-screen bg-gray-50">

    <nav class="bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center sticky top-0 z-40 no-print">
        <div class="flex items-center gap-3">
            <div class="bg-blue-600 p-2 rounded-lg"><i class="fas fa-home text-white"></i></div>
            <h1 class="font-bold text-xl text-gray-800">Eagle Homes Management</h1>
        </div>
        <div class="flex items-center gap-4">
            <button @click="quickSave()" class="bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-blue-700 flex items-center gap-2">
                <i class="fas fa-save"></i> Quick Save
            </button>
            <div class="flex items-center gap-3 border-l pl-4">
                <div class="text-right">
                    <p class="font-medium text-sm" x-text="userRole.toUpperCase()"></p>
                    <p class="text-green-500 text-xs font-bold">‚óè Online</p>
                </div>
                <div class="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center">
                    <i class="fas fa-user-tie text-blue-600"></i>
                </div>
            </div>
        </div>
    </nav>

    <aside class="w-64 bg-white border-r border-gray-200 fixed h-full z-30 pt-4 no-print">
        <nav class="p-4 space-y-2">
            <template x-for="item in menuItems">
                <a href="#" @click.prevent="activeTab = item.id" 
                   :class="activeTab === item.id ? 'sidebar-link active' : 'text-gray-600 hover:bg-gray-50'"
                   class="flex items-center gap-3 px-4 py-3 rounded-lg text-sm font-medium transition">
                    <i :class="item.icon"></i> <span x-text="item.name"></span>
                </a>
            </template>
            
            <div class="pt-10">
                <label class="text-xs text-gray-400 font-bold uppercase px-4">Access Level</label>
                <select x-model="userRole" class="mt-2 w-full mx-2 p-2 border rounded-md text-sm">
                    <option value="owner">Owner</option>
                    <option value="secretary">Secretary</option>
                </select>
            </div>
        </nav>
    </aside>

    <main class="ml-64 pt-6 p-8">
        
        <div x-show="activeTab === 'dashboard'" x-cloak>
            <div class="flex justify-between items-center mb-8">
                <div>
                    <h2 class="text-2xl font-bold text-gray-800">Dashboard Overview</h2>
                    <p class="text-gray-500">Property and financial performance summary.</p>
                </div>
                <button @click="showAddProperty = true" class="bg-orange-500 text-white px-6 py-2 rounded-lg font-bold hover:bg-orange-600 transition flex items-center gap-2">
                    <i class="fas fa-plus-circle"></i> Add New Property
                </button>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="bg-white p-6 rounded-xl border shadow-sm">
                    <p class="text-gray-500 text-sm">Total Expected Rent</p>
                    <h3 class="text-2xl font-bold">Ksh <span x-text="formatNumber(totalExpectedRent)"></span></h3>
                </div>
                <div class="bg-white p-6 rounded-xl border shadow-sm">
                    <p class="text-gray-500 text-sm">Occupancy Rate</p>
                    <h3 class="text-2xl font-bold">85%</h3>
                </div>
                <div class="bg-white p-6 rounded-xl border shadow-sm">
                    <p class="text-gray-500 text-sm">Active Units</p>
                    <h3 class="text-2xl font-bold">50</h3>
                </div>
            </div>
        </div>

        <div x-show="activeTab === 'utilities'" x-cloak>
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-gray-800">Utility Entry</h2>
                <button @click="saveUtilities()" class="bg-green-600 text-white px-5 py-2 rounded-lg font-bold">Save All Readings</button>
            </div>

            <div class="bg-white rounded-xl border overflow-hidden">
                <table class="w-full text-left">
                    <thead class="bg-gray-50 border-b">
                        <tr class="text-xs uppercase font-bold text-gray-600">
                            <th class="p-4">Unit/Tenant</th>
                            <th class="p-4">Water (Ksh)</th>
                            <th class="p-4">Electricity</th>
                            <th class="p-4">Garbage</th>
                            <th class="p-4">Penalty</th>
                            <th class="p-4">Other Bills</th>
                            <th class="p-4">Total</th>
                        </tr>
                    </thead>
                    <tbody>
                        <template x-for="u in utilityData">
                            <tr class="border-b">
                                <td class="p-4">
                                    <div class="font-bold" x-text="u.unit"></div>
                                    <div class="text-xs text-gray-400" x-text="u.tenant"></div>
                                </td>
                                <td class="p-4"><input type="number" x-model.number="u.water" class="w-20 border rounded p-1"></td>
                                <td class="p-4"><input type="number" x-model.number="u.electricity" class="w-20 border rounded p-1"></td>
                                <td class="p-4"><input type="number" x-model.number="u.garbage" class="w-20 border rounded p-1"></td>
                                <td class="p-4"><input type="number" x-model.number="u.penalty" class="w-20 border rounded p-1 text-red-500"></td>
                                <td class="p-4"><input type="number" x-model.number="u.other" class="w-20 border rounded p-1"></td>
                                <td class="p-4 font-bold text-blue-600">Ksh <span x-text="u.water + u.electricity + u.garbage + u.penalty + u.other"></span></td>
                            </tr>
                        </template>
                    </tbody>
                </table>
            </div>
        </div>

        <div x-show="activeTab === 'statement'" x-cloak class="print-area">
            <div class="flex justify-between items-center mb-6 no-print">
                <h2 class="text-2xl font-bold text-gray-800">Landlord Statement</h2>
                <div class="flex gap-2">
                    <button @click="window.print()" class="bg-gray-800 text-white px-4 py-2 rounded-lg flex items-center gap-2">
                        <i class="fas fa-print"></i> Print / PDF
                    </button>
                </div>
            </div>

            <div class="bg-white p-8 rounded-xl border shadow-lg">
                <div class="flex justify-between border-b pb-6 mb-6">
                    <div>
                        <h1 class="text-3xl font-black text-blue-600">EAGLE HOMES</h1>
                        <p class="text-sm text-gray-500">Property Settlement Report</p>
                    </div>
                    <div class="text-right">
                        <p class="font-bold">Date: <span x-text="new Date().toLocaleDateString()"></span></p>
                        <p>Property: <span class="font-bold">Sunset Gardens</span></p>
                    </div>
                </div>

                <div class="overflow-x-auto">
                    <table class="w-full text-sm">
                        <thead class="bg-gray-100 font-bold">
                            <tr>
                                <th class="p-2 border">Date</th>
                                <th class="p-2 border">Hse No.</th>
                                <th class="p-2 border">Tenant</th>
                                <th class="p-2 border">Rent Due</th>
                                <th class="p-2 border">Paid</th>
                                <th class="p-2 border">Deposit</th>
                                <th class="p-2 border">Garbage</th>
                                <th class="p-2 border">Balance</th>
                                <th class="p-2 border">Mode</th>
                                <th class="p-2 border">Remarks</th>
                            </tr>
                        </thead>
                        <tbody>
                            <template x-for="(row, index) in statementRows">
                                <tr>
                                    <td class="border p-1"><input type="date" x-model="row.date" class="w-full border-none"></td>
                                    <td class="border p-1 font-bold"><input type="text" x-model="row.hse" class="w-full border-none"></td>
                                    <td class="border p-1"><input type="text" x-model="row.tenant" class="w-full border-none"></td>
                                    <td class="border p-1 text-right"><input type="number" x-model.number="row.rent" class="w-full border-none text-right"></td>
                                    <td class="border p-1 text-right font-bold"><input type="number" x-model.number="row.paid" class="w-full border-none text-right text-green-600"></td>
                                    <td class="border p-1 text-right"><input type="number" x-model.number="row.deposit" class="w-full border-none text-right"></td>
                                    <td class="border p-1 text-right"><input type="number" x-model.number="row.garbage" class="w-full border-none text-right"></td>
                                    <td class="border p-1 text-right"><span class="text-red-500 font-bold" x-text="row.rent - row.paid"></span></td>
                                    <td class="border p-1">
                                        <select x-model="row.mode" class="w-full border-none bg-transparent">
                                            <option>M-Pesa</option>
                                            <option>Cash</option>
                                            <option>Bank</option>
                                        </select>
                                    </td>
                                    <td class="border p-1"><input type="text" x-model="row.remarks" class="w-full border-none" placeholder="..."></td>
                                </tr>
                            </template>
                        </tbody>
                    </table>
                    <button @click="addStatementRow()" class="no-print mt-2 text-blue-600 text-sm font-bold">+ Add Row</button>
                </div>

                <div class="mt-8 grid grid-cols-2 gap-10">
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <h4 class="font-bold border-b mb-3">Property Expenses</h4>
                        <template x-for="exp in expenses">
                            <div class="flex justify-between mb-2">
                                <input type="text" x-model="exp.desc" class="bg-transparent border-b w-1/2" placeholder="e.g., Repairs">
                                <input type="number" x-model.number="exp.amount" class="bg-transparent border-b w-1/3 text-right font-bold">
                            </div>
                        </template>
                        <button @click="expenses.push({desc: '', amount: 0})" class="no-print text-xs text-blue-600">+ Add Expense</button>
                    </div>

                    <div class="bg-blue-50 p-6 rounded-lg text-right">
                        <div class="flex justify-between mb-2"><span>Total Collected:</span> <span class="font-bold">Ksh <span x-text="calculateTotalPaid()"></span></span></div>
                        <div class="flex justify-between mb-2 text-red-600"><span>Total Expenses:</span> <span class="font-bold">- <span x-text="calculateTotalExpenses()"></span></span></div>
                        <div class="flex justify-between mb-2"><span>Commission (%):</span> <input type="number" x-model.number="commission" class="w-16 border rounded text-right"></div>
                        <div class="flex justify-between border-t pt-2 text-xl font-black text-blue-700">
                            <span>NET PAYOUT:</span>
                            <span>Ksh <span x-text="calculateNetPayout()"></span></span>
                        </div>
                        
                        <div class="mt-4 p-2 bg-white border rounded text-xs text-left italic text-gray-500">
                            <i class="fas fa-robot text-blue-500"></i> AI Calculator: All logic is synced and human-editable.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <div x-show="showAddProperty" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 no-print" x-cloak>
        <div class="bg-white p-8 rounded-xl w-96">
            <h3 class="text-xl font-bold mb-4">Add New Property</h3>
            <div class="space-y-4">
                <input type="text" placeholder="Property Name" class="w-full p-2 border rounded">
                <input type="text" placeholder="Location" class="w-full p-2 border rounded">
                <input type="number" placeholder="Number of Units" class="w-full p-2 border rounded">
                <div class="flex gap-2">
                    <button @click="showAddProperty = false" class="flex-1 bg-gray-200 p-2 rounded">Cancel</button>
                    <button @click="showAddProperty = false" class="flex-1 bg-blue-600 text-white p-2 rounded font-bold">Create</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        function managementSystem() {
            return {
                activeTab: 'dashboard',
                userRole: 'secretary',
                showAddProperty: false,
                totalExpectedRent: 1250000,
                commission: 10,
                
                menuItems: [
                    { id: 'dashboard', name: 'Dashboard', icon: 'fas fa-chart-pie' },
                    { id: 'tenants', name: 'Tenants', icon: 'fas fa-users' },
                    { id: 'utilities', name: 'Utility Entry', icon: 'fas fa-bolt' },
                    { id: 'statement', name: 'Landlord Statement', icon: 'fas fa-file-invoice-dollar' }
                ],

                utilityData: [
                    { unit: 'A1', tenant: 'John Doe', water: 500, electricity: 1200, garbage: 200, penalty: 0, other: 0 },
                    { unit: 'A2', tenant: 'Mary W.', water: 300, electricity: 800, garbage: 200, penalty: 500, other: 100 },
                ],

                statementRows: [
                    { date: '2026-01-05', hse: 'A1', tenant: 'John Doe', rent: 25000, paid: 25000, deposit: 0, garbage: 200, mode: 'M-Pesa', remarks: 'Paid on time' },
                    { date: '2026-01-06', hse: 'A2', tenant: 'Mary W.', rent: 25000, paid: 20000, deposit: 0, garbage: 200, mode: 'Cash', remarks: 'Partial payment' }
                ],

                expenses: [
                    { desc: 'Water Pump Repair', amount: 4500 },
                    { desc: 'Security Guard', amount: 15000 }
                ],

                addStatementRow() {
                    this.statementRows.push({ date: '', hse: '', tenant: '', rent: 0, paid: 0, deposit: 0, garbage: 0, mode: 'M-Pesa', remarks: '' });
                },

                calculateTotalPaid() {
                    return this.statementRows.reduce((sum, row) => sum + row.paid, 0);
                },

                calculateTotalExpenses() {
                    return this.expenses.reduce((sum, exp) => sum + exp.amount, 0);
                },

                calculateNetPayout() {
                    let total = this.calculateTotalPaid();
                    let comm = total * (this.commission / 100);
                    return total - this.calculateTotalExpenses() - comm;
                },

                formatNumber(n) {
                    return n.toLocaleString();
                },

                quickSave() {
                    alert('Data saved successfully to local storage!');
                },

                saveUtilities() {
                    alert('All utility readings updated and balances generated.');
                }
            }
        }
    </script>
</body>
</html>
